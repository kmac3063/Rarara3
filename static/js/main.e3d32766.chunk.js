(this["webpackJsonpmini-app"]=this["webpackJsonpmini-app"]||[]).push([[0],{150:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(37),i=n.n(r),a=n(22),s=n.n(a),d=n(15),o=n.n(d),l=n(21),u=n(20),j=n(11),b=(n(148),n(151)),f=n(6),h=function(e){var t=e.id,n=(e.go,e.fetchedUser,e.callFriend);return Object(f.jsxs)(j.i,{id:t,children:[Object(f.jsx)(j.j,{children:"\u0412\u044b\u0431\u0438\u0440\u0430\u0439 \u0434\u0440\u0443\u0433\u0430"}),Object(f.jsx)(j.e,{onClick:n,before:Object(f.jsx)(b.a,{}),children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0440\u0443\u0433\u0430"})]})},O=(n.p,n(152)),m=function(e){var t,n=e.id,c=e.fetchedUser,r=e.go;return Object(f.jsx)(j.i,{id:n,children:Object(f.jsx)(j.g,{children:Object(f.jsx)(j.l,{icon:Object(f.jsx)(O.a,{}),header:"\u041f\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u043c, "+(t=c,(null==t||null==t.first_name?"\u041f\u0440\u0438\u044f\u0442\u0435\u043b\u044c":c.first_name)+"!"),action:Object(f.jsx)(j.d,{size:"m",onClick:r,"data-to":"Home",children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0441\u043f\u0438\u0441\u043a\u0443 \u0434\u0440\u0443\u0437\u0435\u0439"}),children:"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043e \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u0444\u0438\u043d\u0430\u043b\u0430 \u0445\u0430\u043a\u0430\u0442\u043e\u043d\u0430."})})})},p=n(153),x=n(154),g=n(155),y=n(30),v=function(e){var t=e.id,n=e.go,r=e.fetchedUser,i=e.friend,a=e.meShacking,s=(e.coord,e.speed,e.setMeShacking),d=e.db,o=Object(c.useState)(!1),l=Object(u.a)(o,2),b=l[0],h=l[1],O=Object(c.useState)(!0),m=Object(u.a)(O,2),v=m[0],S=m[1];return Object(c.useEffect)((function(){var e=setInterval((function(){if(null!==i){var e=Object(y.a)(d,"bs",i.id.toString());console.log("friend.id: "+i.id.toString()),Object(y.b)(e).then((function(e){if(e.exists()){var t=e.data();S((function(){return t.friend_id.toString()===r.id.toString()})),h((function(){return t.shake}))}else console.log("Dont exist. id: "+i.id.toString())}))}}),500),t=setInterval((function(){s((function(e){return null===r||null===i||Object(y.d)(Object(y.a)(d,"bs",r.id.toString()),{friend_id:i.id.toString(),shake:e}),e}))}),500);return function(){console.log("unmount"),clearTimeout(e),clearTimeout(t),null!==r&&Object(y.d)(Object(y.a)(d,"bs",r.id.toString()),{friend_id:null,shake:!1})}}),[]),Object(f.jsxs)(j.i,{id:t,children:[Object(f.jsx)(j.j,{left:Object(f.jsx)(j.k,{onClick:n,"data-to":"Home"}),children:"\u0422\u0435\u0442-\u0430-\u0442\u0435\u0442"}),Object(f.jsx)(j.g,{header:Object(f.jsx)(j.h,{mode:"secondary",children:"\u0412\u044b"}),children:Object(f.jsxs)(j.f,{style:{display:"flex"},children:[Object(f.jsx)(j.d,{size:"l",stretched:!0,mode:"commerce",style:{marginRight:8},children:"\u0412\u044b \u0432 \u0442\u0435\u0442-\u0430-\u0442\u0435\u0442"}),a?Object(f.jsx)(j.d,{size:"l",stretched:!0,mode:"commerce",children:"\u0412\u044b \u0442\u0440\u044f\u0441\u0435\u0442\u0435"}):Object(f.jsx)(j.d,{size:"l",stretched:!0,mode:"secondary",children:"\u0412\u044b \u043d\u0435 \u0442\u0440\u044f\u0441\u0435\u0442\u0435"})]})}),Object(f.jsx)(j.g,{header:Object(f.jsx)(j.h,{mode:"secondary",children:(null!==i?i.first_name:"...")+" "+(null!==i?i.last_name:"")}),children:Object(f.jsxs)(j.f,{style:{display:"flex"},children:[v?Object(f.jsx)(j.d,{size:"l",stretched:!0,mode:"commerce",style:{marginRight:8},children:"\u0412 \u0442\u0435\u0442-\u0430-\u0442\u0435\u0442"}):Object(f.jsx)(j.d,{size:"l",stretched:!0,mode:"secondary",style:{marginRight:8},children:"\u041d\u0435 \u0432 \u0442\u0435\u0442-\u0430-\u0442\u0435\u0442"}),b?Object(f.jsx)(j.d,{size:"l",stretched:!0,mode:"commerce",children:"\u0422\u0440\u044f\u0441\u0435\u0442"}):Object(f.jsx)(j.d,{size:"l",stretched:!0,mode:"secondary",children:"\u041d\u0435 \u0442\u0440\u044f\u0441\u0435\u0442"})]})}),Object(f.jsx)(j.n,{}),a&&v&&b?Object(f.jsxs)(j.f,{style:{margin:0,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",textAlign:"center",padding:32},children:[Object(f.jsx)(j.c,{children:Object(f.jsx)(p.a,{})}),Object(f.jsx)(j.e,{children:"\u0412\u044b \u0442\u0440\u044f\u0441\u0435\u0442\u0435 \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e!"}),Object(f.jsx)(j.c,{children:Object(f.jsx)(p.a,{})})]}):Object(f.jsx)(j.l,{icon:a?Object(f.jsx)(x.a,{fill:"DC143C"}):Object(f.jsx)(g.a,{fill:"DC143C"}),header:"\u0422\u0440\u044f\u0441\u044c\u0442\u0438 \u043d\u0443\u0436\u043d\u043e \u0441\u0438\u043b\u044c\u043d\u043e!"})]})},S=n(51),k=function(){arguments.length>0&&void 0!==arguments[0]||allowedList;return function(){var e=Object(c.useState)("WelcomeScreen"),t=Object(u.a)(e,2),n=t[0],r=t[1],i=Object(c.useState)(null),a=Object(u.a)(i,2),d=a[0],b=a[1],O=Object(c.useState)(Object(f.jsx)(j.m,{size:"large"})),p=Object(u.a)(O,2),x=p[0],g=p[1],k=Object(c.useState)(null),z=Object(u.a)(k,2),A=(z[0],z[1]),I=Object(c.useState)(null),_=Object(u.a)(I,2),w=_[0],C=_[1],U=Object(c.useState)(null),W=Object(u.a)(U,2),K=W[0],V=W[1],M=Object(c.useState)(0),F=Object(u.a)(M,2),D=F[0],T=F[1],H=Object(c.useState)({x:0,y:0,z:0}),R=Object(u.a)(H,2),E=R[0],G=R[1],q=Object(c.useState)(10),B=Object(u.a)(q,2),J=(B[0],B[1],Object(S.a)({apiKey:"AIzaSyAdyvR02PGXySkvscIH9y8rktyVQXYzUIk",authDomain:"rarara3-ead99.firebaseapp.com",projectId:"rarara3-ead99",storageBucket:"rarara3-ead99.appspot.com",messagingSenderId:"317914636705",appId:"1:317914636705:web:a033f970a56b50ec49abe0"})),P=Object(y.c)(J);Object(c.useEffect)((function(){function e(){return(e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(null),e.next=3,s.a.send("VKWebAppGetUserInfo");case 3:t=e.sent,s.a.send("VKWebAppAccelerometerStart",{refresh_rate:200}),b(t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s.a.subscribe((function(e){var t=e.detail,n=t.type,c=t.data;if("VKWebAppUpdateConfig"===n){var r=document.createAttribute("scheme");r.value="client_light",A(r.value),document.body.attributes.setNamedItem(r)}if("VKWebAppAccelerometerChanged"===n){var i=c.x,a=c.y,s=c.z,d=Math.sqrt(i*i+a*a+s*s);V((function(){return d>11})),T((function(){return d})),G((function(){return{x:i,y:a,z:s}}))}}));var t=setInterval((function(){var e=E,t=null;setTimeout((function(){t=E,e.x===t.x&&e.y===t.y&&e.z===t.z&&s.a.send("VKWebAppAccelerometerStart",{refresh_rate:200})}),500)}),1e3);function n(){return(n=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=setInterval((function(){var e={x:0+5*Math.random(),y:1-5*Math.random(),z:9+5*Math.random()},t=e.x,n=e.y,c=e.z,r=Math.sqrt(t*t+n*n+c*c);V((function(){return r>11})),T((function(){return r})),G((function(){return{x:t,y:n,z:c}}))}),300);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){n.apply(this,arguments)}(),function(){null!==t&&clearTimeout(t)}}),[]);var X=function(e){r(e.currentTarget.dataset.to)},L=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.a.send("VKWebAppGetFriends",{}).then((function(e){C((function(){return e.users[0]})),r((function(){return"Friend"}))})),t={id:"0",first_name:"Albert",last_name:"Usmanov",sex:2,photo_200:"..."},C((function(){return t})),r((function(){return"Friend"})),b({id:"1"});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(f.jsx)(j.a,{children:Object(f.jsx)(j.b,{children:Object(f.jsxs)(j.o,{activePanel:n,popout:x,children:[Object(f.jsx)(m,{id:"WelcomeScreen",fetchedUser:d,go:X}),Object(f.jsx)(h,{id:"Home",fetchedUser:d,go:X,callFriend:L}),Object(f.jsx)(v,{id:"Friend",fetchedUser:d,go:X,friend:w,meShacking:K,setMeShacking:V,coord:E,speed:D,db:P})]})})})}()};s.a.send("VKWebAppInit"),i.a.render(Object(f.jsx)(k,{}),document.getElementById("root"))}},[[150,1,2]]]);
//# sourceMappingURL=main.e3d32766.chunk.js.map